<!DOCTYPE html>
<html>
<head>    <title>Azure DevOps Search API Documentation</title>
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 20px; 
            line-height: 1.6;
            color: #333;
        }
        pre { 
            background: #f5f5f5; 
            padding: 15px; 
            border-radius: 5px; 
            overflow-x: auto;
        }
        code { 
            background: #f5f5f5; 
            padding: 2px 5px; 
            border-radius: 3px;
        }
        h1, h2, h3 { 
            color: #333; 
            margin-top: 2em;
        }        .endpoint {
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        .method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 3px;
            font-weight: bold;
            margin-right: 10px;
        }
        .post {
            background-color: #49cc90;
            color: white;
        }
        .get {
            background-color: #61affe;
            color: white;
        }
        .delete {
            background-color: #f93e3e;
            color: white;
        }
        .put {
            background-color: #fca130;
            color: white;
        }
        .note {
            background: #e8f4f8;
            padding: 15px;
            border-radius: 5px;
            margin: 1em 0;
        }
    </style>
</head>
<body>    <h1>Azure DevOps Search API Documentation</h1>
    <p>API for searching Azure DevOps repositories and generating AI responses.</p>

    <div class="endpoint">
        <h2>1. Document Search</h2>
        <p><span class="method post">POST</span> <code>/api/search</code></p>
        <p>Search documents with AI-powered analysis. Supports streaming responses and custom prompts.</p>
        
        <div class="example">
            <h3>Request Example</h3>
            <pre>
{
    "sources": [
        {
            "query": "account table schema",
            "repositories": ["AdsAppsMT", "AdsAppsDB"]
        }
    ],
    "stream_response": false,
    "custom_prompt": "Explain the table structure and its relationships"
}
            </pre>

            <h3>Response Examples</h3>
            <h4>Success (Non-Streaming)</h4>
            <pre>
{
    "status": "success",
    "content": "The Account table contains the following fields...",
    "error": null
}
            </pre>

            <h4>Streaming Response (SSE)</h4>
            <pre>
// First event
{
    "event": "prompt",
    "data": {
        "message": "Processing request...",
        "content": "",
        "done": false
    }
}

// Content stream
{
    "event": "message",
    "data": {
        "content": "The Account table structure...",
        "message": "",
        "done": false
    }
}
            </pre>
        </div>
    </div>    <div class="endpoint">
        <h2>2. Scope Script Search</h2>
        <p><span class="method post">POST</span> <code>/api/search/scope</code></p>
        <p>Specialized search for scope scripts with AI analysis. Returns analyzed code samples and knowledge base insights.</p>
        
        <div class="example">
            <h3>Request Example</h3>
            <pre>
{
    "repository": "AdsAppsMT",
    "branch": "master",
    "max_results": 10,
    "stream_response": false,
    "custom_prompt": "Explain the SCOPE script usage patterns"
}
            </pre>

            <h3>Response Example</h3>
            <pre>
{
    "status": "success",
    "content": "This SCOPE script demonstrates the following patterns...",
    "error": null
}
            </pre>
        </div>
    </div>    <div class="endpoint">
        <h2>3. Chat</h2>
        <p><span class="method post">POST</span> <code>/api/chat</code></p>
        <p>Interactive chat with AI, supporting repository context and deep research capabilities. Features iterative research and contextual understanding.</p>
        
        <div class="example">
            <h3>Request Example</h3>
            <pre>
{
    "messages": [
        {
            "role": "user",
            "content": "How are account and accountcustomerrelation tables related?"
        }
    ],
    "stream_response": false
}
            </pre>

            <h3>With Query Parameters</h3>
            <pre>
POST /api/chat?repositories=AdsAppsMT,AdsAppsDB&is_deep_research=false&temperature=0.7
            </pre>

            <h3>Deep Research Response Stream</h3>
            <pre>
{
    "event": "processing",
    "data": {
        "message": "Starting deep research...",
        "content": "",
        "done": false
    }
}

{
    "event": "message",
    "data": {
        "content": "Analyzing table relationships...",
        "message": "Processing iteration 1/5",
        "done": false
    }
}
            </pre>
        </div>

        <div class="note">
            <strong>Query Parameters:</strong>
            <ul>
                <li><code>repositories</code>: Comma-separated list of repositories, Optional</li>
                <li><code>is_deep_research</code>: Enable thorough analysis (default: false)</li>
                <li><code>temperature</code>: Response creativity (0.0-2.0, default: 0.7)</li>
            </ul>
        </div>
    </div>    <div class="endpoint">
        <h2>Error Handling</h2>
        <div class="example">
            <h3>HTTP Status Codes</h3>
            <table>
                <tr>
                    <th>Code</th>
                    <th>Description</th>
                    <th>Examples</th>
                </tr>
                <tr>
                    <td>400</td>
                    <td>Bad Request</td>
                    <td>No relevant content found, Search failure</td>
                </tr>
                <tr>
                    <td>500</td>
                    <td>Internal Server Error</td>
                    <td>Unexpected server exceptions</td>
                </tr>
            </table>

            <h3>Error Structure</h3>
            <h3>Invalid Request</h3>
            <pre>
{
    "status": "error",
    "detail": "Invalid request format. Field 'sources' is required."
}
            </pre>

            <h3>Authentication Error</h3>
            <pre>
{
    "status": "error",
    "detail": "Invalid or missing authentication credentials."
}
            </pre>
        </div>
    </div>
</body>
</html>
